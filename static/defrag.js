// Generated by CoffeeScript 1.3.3
(function() {
  var clusterSprites, clusters;

  clusters = [];

  clusterSprites = {
    0: 'cluster beginning',
    1: 'cluster middle',
    2: 'cluster end',
    3: 'cluster optimized',
    4: 'cluster free',
    5: 'cluster unmoved',
    6: 'cluster bad',
    7: 'cluster read',
    8: 'cluster write'
  };

  $(function() {
    var canvas, clusterH, clusterW, ctx, drawCluster, i, sizeCanvas;
    canvas = document.getElementById('cluster-canvas');
    ctx = canvas.getContext('2d');
    clusterW = 7;
    clusterH = 9;
    i = 0;
    $(window).resize(function() {
      return sizeCanvas();
    });
    sizeCanvas = function() {
      var height, numCluster, width;
      if (window.drawer) {
        clearInterval(window.drawer);
      }
      i = 0;
      width = $('#viewer').width();
      height = $('#viewer').height();
      canvas.width = width;
      canvas.height = height;
      numCluster = Math.round((width / clusterW) * (height / clusterH));
      return drawCluster();
    };
    drawCluster = function() {
      var clusterSprite;
      clusterSprite = new Image();
      clusterSprite.src = 'imgs/cluster_sprites.png';
      return clusterSprite.onload = function() {
        var clusterX, clusterY, srcX, srcY;
        if (window.drawer) {
          clearInterval(window.drawer);
        }
        srcX = 0;
        srcY = 0;
        clusterX = -5;
        clusterY = 0;
        return window.drawer = setInterval(function() {
          var height, width;
          width = $('#viewer').width();
          height = $('#viewer').height();
          i++;
          if ((i * clusterW + 1) > (width - clusterW * 5)) {
            i = 0;
            clusterX = -5;
            clusterY += 10;
          }
          if (clusterY > (height - clusterH)) {
            console.log('clusterY, height', clusterY, height);
            clearInterval(window.drawer);
            sizeCanvas();
          }
          return ctx.drawImage(clusterSprite, srcX + clusterW * parseInt(Math.random() * 9), srcY, clusterW, clusterH, clusterX += 8, clusterY, clusterW, clusterH);
        }, 1);
      };
    };
    return sizeCanvas();
  });

}).call(this);
